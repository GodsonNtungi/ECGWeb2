============================================================
ECGWeb2 V2 - Model Training
============================================================
Loading data from TestData/synthetic_ecg_train.csv...
Data shape: (5000, 187)
Columns: 187
Features shape: (5000, 186)
Labels shape: (5000,)

Class distribution:
  Class 0: 3423 (68.46%)
  Class 1: 1577 (31.54%)

Splitting data (test_size=0.2)...
Training set: (4000, 186)
Test set: (1000, 186)

Training CatBoost model...
Parameters: {'iterations': 1000, 'learning_rate': 0.03, 'depth': 8, 'l2_leaf_reg': 3, 'loss_function': 'Logloss', 'eval_metric': 'AUC', 'random_seed': 42, 'verbose': 100, 'early_stopping_rounds': 50, 'task_type': 'CPU'}
0:	test: 0.6798980	best: 0.6798980 (0)	total: 103ms	remaining: 1m 42s
100:	test: 0.9073850	best: 0.9073850 (100)	total: 1.33s	remaining: 11.9s
200:	test: 0.9303580	best: 0.9303580 (200)	total: 2.57s	remaining: 10.2s
300:	test: 0.9397103	best: 0.9397103 (300)	total: 3.84s	remaining: 8.92s
400:	test: 0.9435199	best: 0.9435199 (399)	total: 5.06s	remaining: 7.56s
500:	test: 0.9448917	best: 0.9451280 (492)	total: 6.27s	remaining: 6.25s
600:	test: 0.9460735	best: 0.9462774 (586)	total: 7.5s	remaining: 4.98s
700:	test: 0.9468057	best: 0.9469911 (695)	total: 8.71s	remaining: 3.71s
Stopped by overfitting detector  (50 iterations wait)

bestTest = 0.9469910787
bestIteration = 695

Shrink model to first 696 iterations.

✓ Model trained successfully!
Best iteration: 695
Best score: {'learn': {'Logloss': 0.024146923065185545}, 'validation': {'Logloss': 0.24346926689749923, 'AUC': 0.9469910786699108}}

============================================================
MODEL EVALUATION
============================================================

Accuracy:  0.9270
Precision: 0.9515
Recall:    0.8095
F1 Score:  0.8748
ROC AUC:   0.9470

Classification Report:
              precision    recall  f1-score   support

      Normal       0.92      0.98      0.95       685
    Abnormal       0.95      0.81      0.87       315

    accuracy                           0.93      1000
   macro avg       0.93      0.90      0.91      1000
weighted avg       0.93      0.93      0.93      1000


Confusion Matrix:
[[672  13]
 [ 60 255]]

✓ Evaluation plots saved to models_eval/

Performing 5-fold cross-validation...
0:	total: 54.3ms	remaining: 54.3s
100:	total: 1.25s	remaining: 11.2s
200:	total: 2.46s	remaining: 9.76s
300:	total: 3.67s	remaining: 8.51s
400:	total: 4.85s	remaining: 7.25s
500:	total: 6.13s	remaining: 6.11s
600:	total: 7.44s	remaining: 4.94s
700:	total: 8.69s	remaining: 3.71s
800:	total: 9.93s	remaining: 2.47s
900:	total: 11.2s	remaining: 1.23s
999:	total: 12.4s	remaining: 0us
0:	total: 11.7ms	remaining: 11.7s
100:	total: 1.24s	remaining: 11s
200:	total: 2.51s	remaining: 9.97s
300:	total: 3.77s	remaining: 8.77s
400:	total: 5.05s	remaining: 7.54s
500:	total: 6.26s	remaining: 6.24s
600:	total: 7.47s	remaining: 4.96s
700:	total: 8.75s	remaining: 3.73s
800:	total: 10s	remaining: 2.49s
900:	total: 11.3s	remaining: 1.24s
999:	total: 12.5s	remaining: 0us
0:	total: 12.4ms	remaining: 12.4s
100:	total: 1.3s	remaining: 11.5s
200:	total: 2.52s	remaining: 10s
300:	total: 3.75s	remaining: 8.71s
400:	total: 4.98s	remaining: 7.44s
500:	total: 6.23s	remaining: 6.21s
600:	total: 7.45s	remaining: 4.95s
700:	total: 8.66s	remaining: 3.69s
800:	total: 9.84s	remaining: 2.44s
900:	total: 11.1s	remaining: 1.22s
999:	total: 12.3s	remaining: 0us
0:	total: 12.4ms	remaining: 12.4s
100:	total: 1.24s	remaining: 11s
200:	total: 2.44s	remaining: 9.71s
300:	total: 3.6s	remaining: 8.37s
400:	total: 4.76s	remaining: 7.11s
500:	total: 5.99s	remaining: 5.96s
600:	total: 7.26s	remaining: 4.82s
700:	total: 8.49s	remaining: 3.62s
800:	total: 9.74s	remaining: 2.42s
900:	total: 10.9s	remaining: 1.2s
999:	total: 12.1s	remaining: 0us
0:	total: 12.5ms	remaining: 12.4s
100:	total: 1.23s	remaining: 10.9s
200:	total: 2.48s	remaining: 9.85s
300:	total: 3.74s	remaining: 8.68s
400:	total: 5.01s	remaining: 7.48s
500:	total: 6.28s	remaining: 6.25s
600:	total: 7.51s	remaining: 4.99s
700:	total: 8.71s	remaining: 3.71s
800:	total: 9.91s	remaining: 2.46s
900:	total: 11.1s	remaining: 1.23s
999:	total: 12.4s	remaining: 0us
CV ROC AUC scores: [0.94771336 0.96003353 0.96076642 0.95708782 0.95080958]
Mean CV ROC AUC: 0.9553 (+/- 0.0103)

Saving model to Models/ECGModelV2.pkl...
✓ Model saved successfully!
✓ Model info saved to Models/ECGModelV2_info.txt

============================================================
✓ Training completed successfully!
============================================================
